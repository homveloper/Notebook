07 해시함수
===

# 1. 해시 함수

해시 함수는 임의의 비트열을 고정 비트열로 변환하는 역할을 합니다. 디지털 서명, 데이터 무결성 검증에 이용되고 있습니다. 해시 함수가 되기 위해서는 다음 조건 필요합니다.

- 임의의 크기의 입력 M에 적용 가능할 것
- 일정한 크기 H=h(M)을 출력할 것
- h와 M이 주어졌을 때 H=h(M)이 계산하기 쉬울 것
- H=h(M)이 주어졌을 때 M을 구하는 역계산이 계산상 불가능할 것
- 주어진 블록 x에 대해, h(x) = h(y)를 만족하는 y≠x를 찾는 것이 계산적으로 불가능
- h(x) = h(y)를 만족하는 쌍 (x, y)를 찾는 것이 계산적으로 불가능

# 2. 메시지 인증(Message Authenication)

메시지 인증은 다음 사항을 확인합니다. 적극 공격으로부터 데이터와 트랜잭션을 보호합니다.

- 메시지 송신자 확인
- 메시지 내용 변경점 확인
- 메시지의 시간성과 메시지의 상대적 순서 확인

## Message Digest

데이터에 대한 fingerprint입니다. 메시지가 변경되지 않았음을 보장하는 용도로 사용됩니다. 전송된 Digest와 전송받은 메시지로 부터 얻은 Digest를 비교 하여 메시지의 변조 여부를 확인합니다. Digest는 보통 해시 함수를 통해 만들어집니다.

아래 그림은 Message Digest의 구조입니다. 메시지 M을 Message Digest Algorithm을 통해  Digest를 생성하여 M과 Digest를 전송합니다. 수신측은 M를 Message Digest Algorithm에 넣어 얻은 Digest와 수신한 Digest를 비교하여 메시지 변조 여부를 확인합니다.

![alt](image/07%20Message%20Digest.png)

# 3. Password Authentication

Message Digest가 일방향(one-way) 데이터 변환, 즉 Digest로 부터 원문을 얻을 수 없다는 특성을 이용하여 사용자의 패스워드를 Message Digest 방법을 사용하여 저장합니다.

1. 패스워드 저장

    새로운 임의의 salt를 생성하여 패스워드 앞에 추가하고 이를 해싱합니다. salt와 해시 결과를 저장해둡니다.

    ![](image/07%20패스워드%20저장.png)

2. 패스워드 인증

    사용자로부터 입력받은 패스워드 앞에 저장된 패스워드 파일에 기록되어 있는 salt를 추가하고 이를 해싱합니다. 해시 결과와 저장된 해시 값과 비교합니다.

    ![alt](image/07%20패스워드%20기반%20인증%20방법%20-%2020161213%20최범휘.png)

# 4. 해시 알고리즘

## 4.1 SHA-1. Secure Hash Algorithm

### 특징

- MD4 기반
- 160bit 해시값 생성
- 

## Revised Secure Hash Standard

SHA-256, SHA-384, SHA-512

AES 암호의 향상된 보안과의 호환성을 위해 설계되었다. 구조 및 구현이 SHA-1과 유사하나 보안 수준이 더 높아졌다. 

## SHA-512

### 특징

- 1024bit block 단위
- 80round 구성

    - 각 라운드 마다 512bit 버퍼를 갱신한다.
    - 현 메시지 블록에서 유도된 64bit 값과 Wt를 사용한다.
    - 첫 80개 소수의 삼제곱근에 기초한 라운드 상수 Kt를 사용한다.

![alt](image/07%20SHA-512%20구조.png)

## MD4

32bit 기반 구조를 가지는 빠른 알고리즘으로 구성되었다. 

입력은 512bit blocks( 16개의 32bit block)이며 출력은 128bit hash value가 나오게 된다.

## MD5

MD4를 개선하였다. MD4는 3단계로, MD5는 4단계로 각 단계별 16번의 서로 다른 연산을 수행한다. 사용하는 함수가 약간 다르며, 이로 인해 MD5가 더 높은 보안성을 가진다.

## Whirlpool

수정된 AES 내부를 압축 함수로 사용한다. SHA와 같은 전용 알고리즘에 필적하는 성능을 가진 블록 암호의 사용에 대한 우려 해소시킵니다.

![alt](image/07%20Whirlpool%20구조.png)

### Whirlpool Block Cipher

AES의 보안 및 효율성과 512비트 블록 크기에 해시 함수를 사용하도록 특별히 설계되었습니다. 그래서 AES와 비슷한 구조와 기능을 가지고 있지만 매핑된 행을 입력하면 10라운드가 서로 다른 S-box 설계 및 값을 사용합니다. SHA보다 더 많은 h/w가 필요한 것처럼 보이지만, 더 나은 결과 성능 제공합니다.

# 5. 메시지 인증 코드

Messge Digest의 약점 (man-in-the-middle attack에 취약)을 보완하여, 다이제스트 생성 시 비밀키를 이용합니다. 

![alt](image/07%20메시지%20인증%20코드.png)

MAC으로 보호 가능한 공격 유형은 2가지 입니다.

- 메시지 변경
- 위장

## MAC 생성 방법

일방향 해시 함수를 이용한 방법

- 관용 암호 사용
- 공개키 암호 사용
- 비밀값 사용

![alt](image/07%20MAC%20생성방법.png)

![](image/07%20MAC%20생성방법2.png)

## HMAC

SHA-1과 같은 암호적 해시함수를 사용하여 만들어진 MAC을 사용합니다. 

### 특징

- 암호적 해시 함수는 관용 암호 알고리즘인 DES에 비해 속도가 빠릅니다.
- 암호적 해시 함수에 대한 코드를 쉽게 구할 수 있습니다.
- 수출에 대한 규제가 없습니다.
- SSL/TLS 그리고 SET 등의 다른 인터넷 프로토콜에서 사용되고 있습니다.ㄴ
- HMAC에서는 해시 함수를 블랙박스 취급합니다. 이를 통해 더 좋은 해시함수를 쉽게 대치할 수 있습니다. 

![alt](image/07%20HMAC%20구조.png)